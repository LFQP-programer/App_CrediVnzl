<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="App_CrediVnzl.Pages.NuevoPrestamoPage"
             Title="Nuevo Prestamo"
             Shell.NavBarIsVisible="True"
             Shell.BackgroundColor="{StaticResource Tertiary}"
             Shell.ForegroundColor="{StaticResource White}"
             Shell.TitleColor="{StaticResource White}"
             BackgroundColor="{StaticResource Background}">

    <ScrollView>
        <VerticalStackLayout Padding="20" Spacing="20">

            <Frame BackgroundColor="{StaticResource Primary}"
                   CornerRadius="15"
                   Padding="20"
                   HasShadow="False">
                <Label Text="Sistema de interes sobre saldo"
                       FontSize="16"
                       TextColor="{StaticResource Tertiary}"
                       HorizontalOptions="Center"
                       FontAttributes="Bold" />
            </Frame>

            <Frame BackgroundColor="{StaticResource Surface}"
                   CornerRadius="15"
                   Padding="20"
                   HasShadow="True"
                   BorderColor="{StaticResource Tertiary}">
                <VerticalStackLayout Spacing="10">
                    <HorizontalStackLayout Spacing="8">
                        <HorizontalStackLayout.GestureRecognizers>
                            <TapGestureRecognizer Command="{Binding ToggleCondicionesCommand}" />
                        </HorizontalStackLayout.GestureRecognizers>
                        
                        <Label Text="â„¹ï¸"
                               FontSize="18"
                               VerticalOptions="Start" />
                        <Label Text="Condiciones del Prestamo"
                               FontSize="16"
                               FontAttributes="Bold"
                               TextColor="{StaticResource Tertiary}"
                               VerticalOptions="Center" />
                        <Label Text="{Binding CondicionesExpandidas, Converter={StaticResource BoolToExpandIconConverter}}"
                               FontSize="16"
                               TextColor="{StaticResource Primary}"
                               HorizontalOptions="EndAndExpand"
                               VerticalOptions="Center" />
                    </HorizontalStackLayout>

                    <Label Text="ðŸ‘† Toca para ver las condiciones"
                           FontSize="11"
                           TextColor="#9E9E9E"
                           Margin="26,0,0,0"
                           IsVisible="{Binding CondicionesExpandidas, Converter={StaticResource InvertBoolConverter}}" />

                    <VerticalStackLayout Spacing="10" IsVisible="{Binding CondicionesExpandidas}">
                        <Label Text="â€¢ Interes fijo del 5% semanal sobre el saldo pendiente"
                               FontSize="14"
                               TextColor="#424242"
                               Margin="26,5,0,0" />

                        <Label Text="â€¢ Sin interes sobre interes"
                               FontSize="14"
                               TextColor="#424242"
                               Margin="26,0,0,0" />

                        <Label Text="â€¢ Pagos flexibles: puede abonar al capital cuando desee"
                               FontSize="14"
                               TextColor="#424242"
                               Margin="26,0,0,0" />

                        <Label Text="â€¢ El interes se recalcula automaticamente al reducir el capital"
                               FontSize="14"
                               TextColor="#424242"
                               Margin="26,0,0,0" />
                    </VerticalStackLayout>
                </VerticalStackLayout>
            </Frame>

            <VerticalStackLayout Spacing="8">
                <Label Text="Cliente"
                       FontSize="16"
                       FontAttributes="Bold"
                       TextColor="#212121" />
                
                <Frame BackgroundColor="White"
                       CornerRadius="10"
                       Padding="0"
                       HasShadow="True"
                       BorderColor="#E0E0E0">
                    <Picker x:Name="pickerCliente"
                            Title="Seleccione un cliente"
                            ItemsSource="{Binding Clientes}"
                            ItemDisplayBinding="{Binding NombreCompleto}"
                            SelectedItem="{Binding ClienteSeleccionado}"
                            FontSize="16"
                            TextColor="#212121"
                            Margin="10,5" />
                </Frame>
            </VerticalStackLayout>

            <VerticalStackLayout Spacing="8">
                <Label Text="Monto del Prestamo"
                       FontSize="16"
                       FontAttributes="Bold"
                       TextColor="#212121" />
                
                <Label Text="Maximo recomendado: S/500"
                       FontSize="12"
                       TextColor="#757575" />

                <Frame BackgroundColor="White"
                       CornerRadius="10"
                       Padding="15"
                       HasShadow="True"
                       BorderColor="#E0E0E0">
                    <Entry x:Name="entryMonto"
                           Placeholder="500"
                           Text="{Binding MontoInicial}"
                           Keyboard="Numeric"
                           FontSize="16"
                           TextColor="#212121" />
                </Frame>
            </VerticalStackLayout>

            <VerticalStackLayout Spacing="8">
                <Label Text="Fecha de Inicio"
                       FontSize="16"
                       FontAttributes="Bold"
                       TextColor="#212121" />

                <Frame BackgroundColor="White"
                       CornerRadius="10"
                       Padding="15"
                       HasShadow="True"
                       BorderColor="#E0E0E0">
                    <DatePicker x:Name="dateFechaInicio"
                                Date="{Binding FechaInicio}"
                                Format="dd/MM/yyyy"
                                FontSize="16"
                                TextColor="#212121" />
                </Frame>
            </VerticalStackLayout>

            <Frame BackgroundColor="#FFF3E0"
                   CornerRadius="15"
                   Padding="20"
                   HasShadow="True"
                   BorderColor="#FF9800">
                <VerticalStackLayout Spacing="5">
                    <HorizontalStackLayout Spacing="8">
                        <Label Text="&#x26A0;&#xFE0F;"
                               FontSize="18"
                               VerticalOptions="Start" />
                        <Label Text="Importante:"
                               FontSize="14"
                               FontAttributes="Bold"
                               TextColor="#E65100" />
                    </HorizontalStackLayout>
                    
                    <Label Text="Esta informacion es confidencial. Recuerde enviar los terminos del prestamo de manera privada al cliente."
                           FontSize="12"
                           TextColor="#E65100"
                           Margin="26,0,0,0" />
                </VerticalStackLayout>
            </Frame>

            <Grid ColumnDefinitions="*,*" ColumnSpacing="15" Margin="0,10,0,0">
                <Button Grid.Column="0"
                        Text="Cancelar"
                        BackgroundColor="{StaticResource Surface}"
                        TextColor="{StaticResource Gray600}"
                        BorderColor="{StaticResource Gray300}"
                        BorderWidth="1"
                        FontSize="16"
                        CornerRadius="10"
                        HeightRequest="50"
                        Command="{Binding CancelarCommand}" />

                <Button Grid.Column="1"
                        Text="Crear Prestamo"
                        BackgroundColor="{StaticResource Primary}"
                        TextColor="{StaticResource Tertiary}"
                        FontSize="16"
                        FontAttributes="Bold"
                        CornerRadius="10"
                        HeightRequest="50"
                        Command="{Binding CrearPrestamoCommand}" />
            </Grid>

        </VerticalStackLayout>
    </ScrollView>
</ContentPage>
