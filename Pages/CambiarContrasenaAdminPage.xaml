<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:viewmodels="clr-namespace:App_CrediVnzl.ViewModels"
             xmlns:helpers="clr-namespace:App_CrediVnzl.Helpers"
             x:Class="App_CrediVnzl.Pages.CambiarContrasenaAdminPage"
             Title="Cambiar Contraseña"
             BackgroundColor="{StaticResource Tertiary}"
             Shell.NavBarIsVisible="False">

    <ContentPage.BindingContext>
        <viewmodels:CambiarContrasenaAdminViewModel />
    </ContentPage.BindingContext>

    <ScrollView>
        <VerticalStackLayout
            Padding="30"
            Spacing="20"
            VerticalOptions="Center">

            <!-- Boton Volver -->
            <Button
                BackgroundColor="Transparent"
                TextColor="{StaticResource Surface}"
                FontSize="16"
                HorizontalOptions="Start"
                Command="{Binding VolverCommand}"
                Margin="0,10,0,20"
                Padding="0"
                ImageSource="{x:Static helpers:IconPaths.Back}"
                Text=" Volver" />

            <!-- Card de Cambio de Contrasena -->
            <Frame
                BackgroundColor="{StaticResource Surface}"
                CornerRadius="20"
                HasShadow="True"
                Padding="30"
                MaximumWidthRequest="400">

                <VerticalStackLayout Spacing="25">
                    
                    <!-- Icono de Seguridad -->
                    <Frame
                        BackgroundColor="{StaticResource Tertiary}"
                        CornerRadius="50"
                        HasShadow="False"
                        Padding="20"
                        WidthRequest="100"
                        HeightRequest="100"
                        HorizontalOptions="Center">
                        <Image Source="{x:Static helpers:IconPaths.Lock}"
                               WidthRequest="60"
                               HeightRequest="60"
                               HorizontalOptions="Center"
                               VerticalOptions="Center" />
                    </Frame>

                    <Label
                        Text="Cambiar Contraseña"
                        FontSize="24"
                        FontAttributes="Bold"
                        TextColor="{StaticResource Tertiary}"
                        HorizontalOptions="Center" />

                    <Label
                        Text="Por seguridad, ingresa tu contraseña actual y luego la nueva"
                        FontSize="13"
                        TextColor="{StaticResource Gray600}"
                        HorizontalOptions="Center"
                        HorizontalTextAlignment="Center"
                        Margin="0,0,0,10" />

                    <!-- Contrasena Actual -->
                    <VerticalStackLayout Spacing="8">
                        <Label
                            Text="Contraseña Actual"
                            FontSize="14"
                            FontAttributes="Bold"
                            TextColor="{StaticResource Tertiary}" />
                        <Frame
                            BorderColor="{StaticResource Gray300}"
                            CornerRadius="10"
                            HasShadow="False"
                            Padding="0">
                            <Grid ColumnDefinitions="50,*" Padding="0">
                                <Border Grid.Column="0"
                                        Padding="8"
                                        BackgroundColor="Transparent">
                                    <Image Source="{x:Static helpers:IconPaths.Lock}"
                                           WidthRequest="24"
                                           HeightRequest="24"
                                           VerticalOptions="Center"
                                           HorizontalOptions="Center" />
                                </Border>
                                <Entry
                                    Grid.Column="1"
                                    Placeholder="Contraseña actual"
                                    Text="{Binding ContrasenaActual}"
                                    IsPassword="True"
                                    FontSize="16"
                                    VerticalOptions="Center" />
                            </Grid>
                        </Frame>
                    </VerticalStackLayout>

                    <!-- Nueva Contrasena -->
                    <VerticalStackLayout Spacing="8">
                        <Label
                            Text="Nueva Contraseña"
                            FontSize="14"
                            FontAttributes="Bold"
                            TextColor="{StaticResource Tertiary}" />
                        <Frame
                            BorderColor="{StaticResource Gray300}"
                            CornerRadius="10"
                            HasShadow="False"
                            Padding="0">
                            <Grid ColumnDefinitions="50,*" Padding="0">
                                <Border Grid.Column="0"
                                        Padding="8"
                                        BackgroundColor="Transparent">
                                    <Image Source="{x:Static helpers:IconPaths.Lock}"
                                           WidthRequest="24"
                                           HeightRequest="24"
                                           VerticalOptions="Center"
                                           HorizontalOptions="Center" />
                                </Border>
                                <Entry
                                    Grid.Column="1"
                                    Placeholder="Nueva contraseña"
                                    Text="{Binding NuevaContrasena}"
                                    IsPassword="True"
                                    FontSize="16"
                                    VerticalOptions="Center" />
                            </Grid>
                        </Frame>
                    </VerticalStackLayout>

                    <!-- Confirmar Contrasena -->
                    <VerticalStackLayout Spacing="8">
                        <Label
                            Text="Confirmar Contraseña"
                            FontSize="14"
                            FontAttributes="Bold"
                            TextColor="{StaticResource Tertiary}" />
                        <Frame
                            BorderColor="{StaticResource Gray300}"
                            CornerRadius="10"
                            HasShadow="False"
                            Padding="0">
                            <Grid ColumnDefinitions="50,*" Padding="0">
                                <Border Grid.Column="0"
                                        Padding="8"
                                        BackgroundColor="Transparent">
                                    <Image Source="{x:Static helpers:IconPaths.Check}"
                                           WidthRequest="24"
                                           HeightRequest="24"
                                           VerticalOptions="Center"
                                           HorizontalOptions="Center" />
                                </Border>
                                <Entry
                                    Grid.Column="1"
                                    Placeholder="Confirmar contraseña"
                                    Text="{Binding ConfirmarContrasena}"
                                    IsPassword="True"
                                    FontSize="16"
                                    VerticalOptions="Center" />
                            </Grid>
                        </Frame>
                    </VerticalStackLayout>

                    <!-- Boton Cambiar Contrasena -->
                    <Button
                        FontSize="18"
                        FontAttributes="Bold"
                        BackgroundColor="{StaticResource Tertiary}"
                        TextColor="{StaticResource Surface}"
                        CornerRadius="10"
                        HeightRequest="50"
                        Command="{Binding CambiarContrasenaCommand}"
                        IsEnabled="{Binding IsLoading, Converter={StaticResource InverseBoolConverter}}"
                        Margin="0,10,0,0"
                        ImageSource="{x:Static helpers:IconPaths.Save}"
                        Text=" Cambiar Contraseña" />

                    <!-- Indicador de carga -->
                    <ActivityIndicator
                        IsRunning="{Binding IsLoading}"
                        IsVisible="{Binding IsLoading}"
                        Color="{StaticResource Tertiary}"
                        HorizontalOptions="Center" />

                </VerticalStackLayout>
            </Frame>

        </VerticalStackLayout>
    </ScrollView>

</ContentPage>